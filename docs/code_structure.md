# Software Overview

| **Software Area**   | **Actions**                                        | **Code**    | **Notes**                                    |
|---------------------|----------------------------------------------------|-------------|----------------------------------------------|
|          Web Server | Edit resources and play game                       | /web        | Currently flask based, will move to fastAPI. |
|         Game Engine | Interaction, Maps, Player, AI, Game state, Scripts | /game_engine |                                              |
| Resource Management | index and maintain resources                       | /chosm      |                                              |
| Might & Magic       | Transform M&M files to resources                   | /mam_game   | Other game importers would be possible.      |

## Web Server
Todo:
  - Get basic game view render
  - port to FastAPI
  - containerise a web stack (https://hub.docker.com/r/tiangolo/uvicorn-gunicorn-fastapi)
  - create a devops pipeline git -> docker -> droplet
  - stream resource files to browser direct via webserver, not the API  

## Game Engine
Todo:
  - Get a running game loop and session manager.
  - Scripting engine

This will be a time-consuming thing to complete and is low priority at the moment. 

## Resource Management
Todo:
  - "edit_packs", zip asset files the user can edit on their local machine, then re-upload.  

Resources have both an ID and a NAME; one or both mush be present.
Neither is required to be globally unique, but must be unique for the resource type (eg sprite).

The following types of resources are supported:
  - Sprite
  - Map
  - NPC Database
  - Script
  - Sound_FX
  - Music
  - Palette

Note: there are no "image" resources, everything is a sprite.

A resource maps to a folder with a name derived from the TYPE + (NAME or ID).
This folder contains multiple files concerning the resource.

Files starting with a "_"  (eg: "_frame_0021.pmg") are considered "secondary files", 
the others are primary files. Secondary files are generated by the resource manager 
from the primary files. They can be safely deleted if modifying game content.

### There are two classes that should be understood regarding CHOSM assets: 

AssetRecord:
  - built for use by the web server
  - store metadata for the viewer and editor
  - store a slug representing the folder
  - stack to override each other
  - validate their own structure
  - can bootstrap an Asset from primary files

Asset:
  - built for use by software creating graphics for the game.
    - Might and magic asset import scripts
    - Sprite resize & creation AI
  - can be created from in memory objects
  - holds raw data, such as images and sound in memory
  - can perform operations on the data
  - can "bake" that data to an asset.
    - by this process, it will create secondary files from primary files

## Might & Magic
Todo:
  - Catalog sprites
  - Load Event scripts
  - Sound FX
  - Music
  - MaM 3 support
  - MaM 1&2 support

This concerns extracting game data and "baking" it to the resource file format.  